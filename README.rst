.. sectnum::

=====================
django-compat-patcher
=====================

A "magic" package which adds retro/forward compatibility patches to Django, so that your app ecosystem doesn't get broken by trivial changes in the core of the framework.

Add :code:`django-compat-patcher` to your pip requirements, install it, and then activate it with::
    
    import django_compat_patcher
    django_compat_patcher.patch()
    
This code must be placed BEFORE any use of django (eg. in your :code:`manage.py` or your :code:`wsgi.py` script).

However, the :code:`DJANGO_SETTINGS_MODULE` environment variable must already be set.

Settings
========

Settings to put in your project's :code:`settings.py`. The value in these settings are the default values.

DCP_INCLUDE_FIXER_IDS
*********************
List of fixer names to include. If :code:`"*"` is used, then all fixers are included.

| **Default:** :code:`"*"`
| **Type:** List of strings, or :code:`"*"`
| **Example:** :code:`DCP_INCLUDE_FIXER_IDS = ['fix_deletion_templatetags_future_url']`

DCP_INCLUDE_FIXER_FAMILIES
**************************
List of fixer families to include.

Note: If you want to include a specific category, remember to remove the :code:`"*"` from :code:`DCP_INCLUDE_FIXER_IDS`.

| **Default:** :code:`[]`
| **Type:** List of strings
| **Choices:** :code:`("djangoX.Y")` where :code:`X` and :code:`Y` are respectively the major and minor versions
| **Example:** :code:`DCP_INCLUDE_FIXER_FAMILIES = ["django1.9"]`

DCP_EXCLUDE_FIXER_IDS
*********************
List of fixer names to exclude.

Note: The "INCLUDE" filters are applied before the "EXCLUDE" ones.

| **Default:** :code:`[]`
| **Type:** List of strings
| **Example:** :code:`DCP_EXCLUDE_FIXER_IDS = ['fix_deletion_templatetags_future_url']`

DCP_EXCLUDE_FIXER_FAMILIES
**************************
List of fixer families to exclude.

Note: The "INCLUDE" filters are applied before the "EXCLUDE" ones.

| **Default:** :code:`[]`
| **Type:** List of strings
| **Choices:** :code:`("djangoX.Y")` where :code:`X` and :code:`Y` are respectively the major and minor versions
| **Example:** :code:`DCP_EXCLUDE_FIXER_FAMILIES = ["django1.6", "django1.9"]`

DCP_PATCH_INJECTED_OBJECT
*************************

The patcher adds a :code:`__dcp_injected__ = True` attribute to the injected callables, modules and classes.

| **Default:** :code:`True`
| **Type:** Boolean
| **Example:** :code:`DCP_PATCH_INJECTED_OBJECT = False`


Table of fixers
===============

There are currently 17 available fixers.

+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Fixer                                                                                                                                                               | Fixer family                                                                                                                                                        | Min version                                                                                                                                                         | Max version                                                                                                                                                         |
+=====================================================================================================================================================================+=====================================================================================================================================================================+=====================================================================================================================================================================+=====================================================================================================================================================================+
| **Preserve the request.raw_post_data alias for request.body.** (:code:`fix_deletion_http_request_HttpRequest_raw_post_data`)                                        | django1.6                                                                                                                                                           | 1.6                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the MergeDict util datastructure** (:code:`fix_deletion_utils_datastructures_MergeDict`)                                                                 | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the SortedDict util datastructure** (:code:`fix_deletion_utils_datastructures_SortedDict`)                                                               | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the dictconfig util file** (:code:`fix_deletion_utils_dictconfig`)                                                                                       | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the importlib util file** (:code:`fix_deletion_utils_importlib`)                                                                                         | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the tzinfo util file** (:code:`fix_deletion_utils_tzinfo`)                                                                                               | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the unittest util file** (:code:`fix_deletion_utils_unittest`)                                                                                           | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the `request.REQUEST` attribute, merging parameters from GET** (:code:`fix_deletion_core_handlers_wsgi_WSGIRequest_REQUEST`)                             | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the get_formsets method of ModelAdmin** (:code:`fix_deletion_contrib_admin_ModelAdmin_get_formsets`)                                                     | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the `url` tag in the `future` templatetags library.** (:code:`fix_deletion_templatetags_future_url`)                                                     | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the `ssi` tag in the `future` templatetags library.** (:code:`fix_deletion_templatetags_future_ssi`)                                                     | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the IPAddressField model field, now superseded by GenericIPAddressField** (:code:`fix_deletion_forms_fields_IPAddressField`)                             | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the fallback to AppCommand.handle_app() method in django management commands.** (:code:`fix_deletion_django_core_management_base_AppCommand_handle_app`) | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve contrib.sites.models.RequestSite alias.** (:code:`fix_deletion_contrib_sites_models_RequestSite`)                                                        | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve contrib.sites.models.get_current_site alias.** (:code:`fix_deletion_contrib_sites_models_get_current_site`)                                              | django1.9                                                                                                                                                           | 1.9                                                                                                                                                                 |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the "future" templatetags library, with its improved `firstof` and `cycle` tags.** (:code:`fix_deletion_templatetags_future`)                            | django1.10                                                                                                                                                          | 1.10                                                                                                                                                                |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Preserve the "ssi" default template tag.** (:code:`fix_deletion_template_defaulttags_ssi`)                                                                        | django1.10                                                                                                                                                          | 1.10                                                                                                                                                                |                                                                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------+
